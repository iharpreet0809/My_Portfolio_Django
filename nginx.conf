# Nginx Configuration for Django Portfolio Application
# This file configures Nginx as a reverse proxy for the Django application

server {
    listen 80;  # Listen on port 80 (HTTP)
    server_name _;  # _ Accept requests for any server name or IP address or domain name

    # Static files location
    # Serve static files (CSS, JavaScript, images) directly from Nginx
    # This is more efficient than serving them through Django
    location /static/ {
        alias /app/staticfiles/;  # Directory where Django collects static filesthis app dir is docker directory where we copied files and have staticfiles folder
        autoindex on;  # Enable directory listing for debugging
    }

    # Main application location
    # Proxy all other requests to the Django application
    location / {
        proxy_pass http://django-app:8000;  # Forward to Django container
        # http://<django_container_name>:8000 is the name of the service in the docker-compose.yml file
        
        # Set proxy headers for proper request handling
        proxy_set_header Host $host;  # Pass the original host header
        proxy_set_header X-Real-IP $remote_addr;  # Pass the real client IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # Pass forwarded IPs
        proxy_set_header X-Forwarded-Proto $scheme;  # Pass the protocol (http/https)
    }
}
